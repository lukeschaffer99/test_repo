#!/usr/bin/Rscript

require(stringr)
require(GenomicSEM)

setwd('/pl/active/IBG/S_GSEM/Annotations/')
sample.prev <- c(.5, .5)
population.prev <-c(.05, .012)
traits<-c("/pl/active/IBG/schaffer/stratified/ASD.sumstats.gz", "/pl/active/IBG/schaffer/stratified/ADHD.sumstats.gz")
trait.names<-c('ASD', 'ADHD')
wld="1000G_Phase3_weights_hm3_no_MHC/"
frq="1000G_Phase3_frq/"
GSEM_sldsc<-s_ldsc(ld=c("1000G_Phase3_baselineLD_v2.2_ldscores/",
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.14.",
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.15.",
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.60.",
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.61.",
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.62.",
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.63.",
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.64.",
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.65.",
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.66.",
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.139.",
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.140.",
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.141.",
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.142.",
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.143.",
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.144.",
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.145.",
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.146.",
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.153.",
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.154.",
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.227.",
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.228.",
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.229.",
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.230.",
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.231.",
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.232.",
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.233.",
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.234.",
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.241.",
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.242.",
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.315.",
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.316.",
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.317.",
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.318.",
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.319.",
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.320.",
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.321.",
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.322.",
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.329.",
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.330.",
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.373.",
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.374.",
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.375.",
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.376.",
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.377.",
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.378.", 
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.control.", 
                        "Multi_tissue_gene_expr_1000Gv3_ldscores/Multi_tissue_gene_expr_1000Gv3_ldscores/GTEx.8.",
                        "Multi_tissue_gene_expr_1000Gv3_ldscores/Multi_tissue_gene_expr_1000Gv3_ldscores/GTEx.9.",
                        "Multi_tissue_gene_expr_1000Gv3_ldscores/Multi_tissue_gene_expr_1000Gv3_ldscores/GTEx.10.",
                        "Multi_tissue_gene_expr_1000Gv3_ldscores/Multi_tissue_gene_expr_1000Gv3_ldscores/GTEx.11.",
                        "Multi_tissue_gene_expr_1000Gv3_ldscores/Multi_tissue_gene_expr_1000Gv3_ldscores/GTEx.12.",
                        "Multi_tissue_gene_expr_1000Gv3_ldscores/Multi_tissue_gene_expr_1000Gv3_ldscores/GTEx.13.",
                        "Multi_tissue_gene_expr_1000Gv3_ldscores/Multi_tissue_gene_expr_1000Gv3_ldscores/GTEx.14.",
                        "Multi_tissue_gene_expr_1000Gv3_ldscores/Multi_tissue_gene_expr_1000Gv3_ldscores/GTEx.15.",
                        "Multi_tissue_gene_expr_1000Gv3_ldscores/Multi_tissue_gene_expr_1000Gv3_ldscores/GTEx.16.",
                        "Multi_tissue_gene_expr_1000Gv3_ldscores/Multi_tissue_gene_expr_1000Gv3_ldscores/GTEx.17.",
                        "Multi_tissue_gene_expr_1000Gv3_ldscores/Multi_tissue_gene_expr_1000Gv3_ldscores/GTEx.18.",
                        "Multi_tissue_gene_expr_1000Gv3_ldscores/Multi_tissue_gene_expr_1000Gv3_ldscores/GTEx.19.",
                        "Multi_tissue_gene_expr_1000Gv3_ldscores/Multi_tissue_gene_expr_1000Gv3_ldscores/GTEx.20.",
                        "Multi_tissue_gene_expr_1000Gv3_ldscores/Multi_tissue_gene_expr_1000Gv3_ldscores/Franke.13.",
                        "Multi_tissue_gene_expr_1000Gv3_ldscores/Multi_tissue_gene_expr_1000Gv3_ldscores/Franke.14.",
                        "Multi_tissue_gene_expr_1000Gv3_ldscores/Multi_tissue_gene_expr_1000Gv3_ldscores/GTEx.42.", 
                        "Multi_tissue_gene_expr_1000Gv3_ldscores/Multi_tissue_gene_expr_1000Gv3_ldscores/Franke.152.", 
                        "Multi_tissue_gene_expr_1000Gv3_ldscores/Multi_tissue_gene_expr_1000Gv3_ldscores/Franke.109.", 
                        "Multi_tissue_gene_expr_1000Gv3_ldscores/Multi_tissue_gene_expr_1000Gv3_ldscores/GTEx.40.", 
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.345.", 
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.152.", 
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.27.",
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.83.",
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.169.",
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.257.", 
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.13.", 
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.71.", 
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.240.",
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.328.", 
                        "Multi_tissue_gene_expr_1000Gv3_ldscores/Multi_tissue_gene_expr_1000Gv3_ldscores/GTEx.1.", 
                        "Multi_tissue_gene_expr_1000Gv3_ldscores/Multi_tissue_gene_expr_1000Gv3_ldscores/Franke.39.", 
                        "Multi_tissue_gene_expr_1000Gv3_ldscores/Multi_tissue_gene_expr_1000Gv3_ldscores/Franke.31.", 
                        "Multi_tissue_gene_expr_1000Gv3_ldscores/Multi_tissue_gene_expr_1000Gv3_ldscores/Franke.30.", 
                        "Multi_tissue_gene_expr_1000Gv3_ldscores/Multi_tissue_gene_expr_1000Gv3_ldscores/Franke.147.", 
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.224.", 
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.54.", 
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.262.", 
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.98.", 
                        "Multi_tissue_chromatin_1000Gv3_ldscores/Multi_tissue_chromatin_1000Gv3_ldscores/Roadmap.223.", 
                        "NewAnnotations/exPFC1.", 
                        "NewAnnotations/PI_genes.", 
                        "NewAnnotations/exPFC2.",
                        "NewAnnotations/OPC.",
                        "NewAnnotations/ODC1.",
                        "NewAnnotations/NSC.",
                        "NewAnnotations/MG.",
                        "NewAnnotations/GABA1.",
                        "NewAnnotations/PIxASC1.", 
                        "NewAnnotations/PIxASC2.",
                        "NewAnnotations/PIxEND.",
                        "NewAnnotations/PIxexCA1.",
                        "NewAnnotations/PIxexPFC2.",
                        "NewAnnotations/PIxexPFC1.",
                        "NewAnnotations/exDG.",
                        "NewAnnotations/exCA1.",
                        "NewAnnotations/PIxMG.",
                        "NewAnnotations/PIxGABA2.",
                        "NewAnnotations/PIxGABA1.",
                        "NewAnnotations/PIxexDG.",
                        "NewAnnotations/ASC2.",
                        "NewAnnotations/ASC1.",
                        "NewAnnotations/END.",
                        "NewAnnotations/PIxNSC.",
                        "NewAnnotations/PIxODC1.",
                        "NewAnnotations/PIxOPC.",
                        "NewAnnotations/PIxexCA3.",
                        "NewAnnotations/exCA3.",
                        "NewAnnotations/GABA2.",
                        "Multi_tissue_gene_expr_1000Gv3_ldscores/Multi_tissue_gene_expr_1000Gv3_ldscores/GTEx.control.",
                        "Multi_tissue_gene_expr_1000Gv3_ldscores/Multi_tissue_gene_expr_1000Gv3_ldscores/Franke.control."),
                   traits=traits,
                   wld=wld,
                   frq=frq,
                   population.prev=population.prev,
                   sample.prev=sample.prev,
                   n.blocks=200,
                   trait.names=trait.names,
		     ldsc.log="/pl/active/IBG/schaffer/stratified/ASD_sldsc_")
save(GSEM_sldsc, file = "/pl/active/IBG/schaffer/stratified/GSEM_sldsc.RData")

